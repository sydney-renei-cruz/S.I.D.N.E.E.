<!DOCTYPE html>
<html>
    <head>
        <link type="text/css" rel="stylesheet" href="css/main.css"/>
		
        
        <script src="js/main.js"></script>
		
		<!-- navbar -->
		<script>
            topBar();
        </script>
		
		<!-- caption will show when you hover on a picture -->
		<script>
                    
			$( document ).ready(function() {
                            showProduct();
				$("[rel='tooltip']").tooltip();    
 
				$('.thumbnail').hover(
					function(){
						$(this).find('.caption').slideDown(250); //.fadeIn(250)
					},
					function(){
						$(this).find('.caption').slideUp(250); //.fadeOut(205)
					}
				); 
			});
		</script>

		<!-- header -->
		<div class="col-lg-12">
			<h1 class="page-header text-center">
				All Products
			</h1>
		</div>
		
		<!-- items -->
		<div class="container productList">
		</div>
                
        <script>
        
        //find the class using the .class selector
        //perform query
        //for every branch place value in new bean
        //parse to string in json format, then append \n for splitting
        function showProduct(){
            $.get('allProductsRetrieve', function(data){
                data = data.split("::::");
                
                for(i = 0; i<(data.length-1); i++){
                    data[i] = JSON.parse(data[i]);
                }
                
                rowCount = 0;
		for(i = 0; i<((data.length/5)); i++){
                    addRow(rowCount);
                    
                    for(j = 0; j<4; j++){
                        JSONInput = data[(i*5) + j];
                        if(JSONInput !== undefined && JSONInput !== "" && JSONInput !== " "){
                            addEntry(JSONInput.productID, JSONInput.productName, rowCount);
                            }
                    }
                    
                    rowCount = rowCount + 1;
                    closeDiv();
                }			
            });
        };
        
        function addRow(rowCount){
            $(".productList").append("<div class=\"row row"+ rowCount +"\">");
        }
        
        function addEntry(data1, data2, rowCount){
            $(".row" + rowCount).append("<div class=\" content\"><div class=\"col-md-3\"><div class=\"thumbnail\"><div class=\"caption\"><h3 class=\"productName\">" + data1 +"</h3><p><a href=\"productPage.html?pid="+ data2 +"\" class=\"label label-danger\" rel=\"tooltip\" title=\"View Product\"> View Product</a></p></div><img class=\"img-responsive img\" src=\"img/products/"+data1+".png\" alt=\"\"></div></div></div>");
    }
        
        function closeDiv(){
            $(".container").append("</div>");
        }
        
        </script>
		<!-- pagination -->
		<nav class="text-center">
			<div class="col-lg-12">
				<ul class="pagination">
					<li class="pag_prev">
						<a href="#" aria-label="Previous">
							<span aria-hidden="true">&laquo;</span>
						</a>
					</li>
					<li class="pag_next">
						<a href="#" aria-label="Next">
							<span aria-hidden="true">&raquo;</span>
						</a>
					</li>
				</ul>
			</div>
		</nav>

		<!-- creating a pagination -->
		<script>
			$( document ).ready(function() { 
    

    pageSize = 12;
    pagesCount = $(".content").length;
    var currentPage = 1;
    
    /////////// PREPARE NAV ///////////////
    var nav = '';
    var totalPages = Math.ceil(pagesCount / pageSize);
    for (var s=0; s<totalPages; s++){
        nav += '<li class="numeros"><a href="#">'+(s+1)+'</a></li>';
    }
    $(".pag_prev").after(nav);
    $(".numeros").first().addClass("active");
    //////////////////////////////////////

    showPage = function() {
        $(".content").hide().each(function(n) {
            if (n >= pageSize * (currentPage - 1) && n < pageSize * currentPage)
                $(this).show();
        });
    }
    showPage();


    $(".pagination li.numeros").click(function() {
        $(".pagination li").removeClass("active");
        $(this).addClass("active");
        currentPage = parseInt($(this).text());
        showPage();
    });

    $(".pagination li.pag_prev").click(function() {
        if($(this).next().is('.active')) return;
        $('.numeros.active').removeClass('active').prev().addClass('active');
        currentPage = currentPage > 1 ? (currentPage-1) : 1;
        showPage();
    });

    $(".pagination li.pag_next").click(function() {
        if($(this).prev().is('.active')) return;
        $('.numeros.active').removeClass('active').next().addClass('active');
        currentPage = currentPage < totalPages ? (currentPage+1) : totalPages;
        showPage();
    });
});
		</script>
		
		
		<!-- back to top link -->
		<span id="top-link-block" class="hidden">
    <a href="#top" class="well well-sm"  onclick="$('html,body').animate({scrollTop:0},'slow');return false;">
        <i class="glyphicon glyphicon-chevron-up"></i>
    </a>
</span><!-- /top-link-block -->
        <script>
			// Only enable if the document has a long scroll bar
			// Note the window height + offset
			if ( ($(window).height() + 100) < $(document).height() ) {
				$('#top-link-block').removeClass('hidden').affix({
			// how far to scroll down before link "slides" into view
				offset: {top:100}
				});
			}
		</script>
		
    </body>
</html>